<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Quantum Hypercube Game</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            background: #d8d7ab;
            font-family: sans-serif;
        }

        #container {
            position: relative;
            width: 400px;
            height: 400px;
        }

        .planet {
            position: absolute;
            width: 120px;
            height: 120px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            color: white;
            font-weight: bold;
        }

        #planet1 { background: #09426a; top: 0; left: 0; }
        #planet2 { background: #9b2012; top: 0; right: 0; }
        #planet3 { background: #0b5329; bottom: 0; left: 0; }
        #planet4 { background: #cc9704; bottom: 0; right: 0; }

        svg {
            position: absolute;
            top: 0;
            left: 0;
            width: 400px;
            height: 400px;
        }

        line {
            stroke: #555;
            stroke-width: 4;
            cursor: pointer;
            transition: stroke 0.3s;
        }

        line:hover { stroke: #000; }

        .person {
            position: absolute;
            font-size: 3rem;
            transition: transform 0.8s ease;
        }

        /* æ­¥æ•¸é¡¯ç¤ºå€ */
        #steps {
            margin-top: 20px;
            font-size: 1.5rem;
            font-weight: bold;
            color: #333;
        }
    </style>
</head>
<body>
    <h2>Quantum Hypercube Game</h2><br>
    <div id="container">
        <svg>
            <line id="line12" x1="40" y1="60" x2="360" y2="60"></line>
            <line id="line13" x1="60" y1="40" x2="60" y2="360"></line>
            <line id="line24" x1="340" y1="40" x2="340" y2="360"></line>
            <line id="line34" x1="40" y1="340" x2="360" y2="340"></line>
        </svg>
        <div class="planet" id="planet1"></div>
        <div class="planet" id="planet2"></div>
        <div class="planet" id="planet3"></div>
        <div class="planet" id="planet4"></div>
    </div>
    <div id="steps">æ­¥æ•¸ï¼š0</div>
    <script>
        const planets = {
            planet1: document.getElementById("planet1"),
            planet2: document.getElementById("planet2"),
            planet3: document.getElementById("planet3"),
            planet4: document.getElementById("planet4"),
        };

        const princes = [
            { emoji: "ğŸ³", target: "planet1" },
            { emoji: "ğŸ·", target: "planet2" },
            { emoji: "ğŸ¸", target: "planet3" },
            { emoji: "ğŸ¥", target: "planet4" }
        ];

        let steps = 0;
        const stepDisplay = document.getElementById("steps");

        const planetKeys = Object.keys(planets);
        function shuffle(array) { return array.sort(() => Math.random() - 0.5); }
        const shuffledPlanets = shuffle([...planetKeys]);
        princes.forEach((prince, i) => {
            const pDiv = document.createElement("div");
            pDiv.classList.add("person");
            pDiv.textContent = prince.emoji;
            planets[shuffledPlanets[i]].appendChild(pDiv);
        });

        const lines = [
            ["line12", "planet1", "planet2"],
            ["line13", "planet1", "planet3"],
            ["line24", "planet2", "planet4"],
            ["line34", "planet3", "planet4"]
        ];

        lines.forEach(([lineId, p1, p2]) => {
            const line = document.getElementById(lineId);
            line.addEventListener("click", () => {
                const personA = planets[p1].querySelector(".person");
                const personB = planets[p2].querySelector(".person");
                if (!personA || !personB) return;

                steps++;
                stepDisplay.textContent = `æ­¥æ•¸ï¼š${steps}`;

                // getBoundingClientRect() : å–å¾—ç‰©ä»¶åœ¨è¦–çª—åº§æ¨™ç³»çš„ä½ç½®èˆ‡å¤§å°
                const rectA = planets[p1].getBoundingClientRect();
                const rectB = planets[p2].getBoundingClientRect();
                const deltaX = rectB.left - rectA.left;
                const deltaY = rectB.top - rectA.top;

                // æ»‘å‹•æ•ˆæœ
                personA.style.transform = `translate(${deltaX}px, ${deltaY}px)`;
                personB.style.transform = `translate(${-deltaX}px, ${-deltaY}px)`;

                setTimeout(() => {
                    planets[p1].appendChild(personB);
                    planets[p2].appendChild(personA);
                    personA.style.transform = '';
                    personB.style.transform = '';
                    checkSuccess();
                }, 800);
            });
        });

        function checkSuccess() {
            const success = princes.every(prince => {
                const planet = planets[prince.target];
                const person = planet.querySelector(".person");
                return person && person.textContent === prince.emoji;
            });
            if (success) { alert(`å“‡ï¼ä½ èŠ±äº† ${steps} æ­¥è®“æ¯å€‹å‹•ç‰©éƒ½å›åˆ°å°æ‡‰ã„‰æ˜Ÿçƒä¸Šè€¶~`); }
        }
    </script>
</body>
</html>
